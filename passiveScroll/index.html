<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Passive scroll</title>
	<style type="text/css">
		p {
			max-width: 50ch;
			margin: 2em auto;
		}
		body, html {
			margin: 0;padding:0;
		}
		li {
			padding: 1em;
			background: #666;
			margin: 0;
			list-style-type: none;
		}
		ul {
			margin: 0;
			padding: 0;
		}
		ul:hover li {
			display: block !important;
		}
		ul:hover + .dummy {
			height: 0;
		}
		.is-active {
			background: #FFF;
		}
		.is-stuck {
			background: #F00;
			position: sticky; 
			top: 0px;
			animation: down .2s cubic-bezier(.2,.8,.4,1) forwards;
		}
		.is-stuck li:not(.is-active) {
			display: none;
		}
		.is-stuck + .dummy {
			height: 102px; /* Since two are hidden */
		}
		/*.dummy {
			background: #FC0;
		}*/
		@keyframes down {
			0% { transform: translateY( -25px ); }
			100% { transform: translateY( 0 ); }
		}
	</style>
</head>
<body>
	<h1>Passive scroll</h1>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eligendi commodi cupiditate laboriosam harum voluptates vitae eveniet maxime. Ab, explicabo recusandae illum natus assumenda! Doloremque facere ea sit reprehenderit reiciendis velit.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ut, sed ea consequatur asperiores tempora, quo aut! Consequatur nobis harum, perspiciatis obcaecati quisquam provident aspernatur iusto at ratione, nam recusandae aliquid?</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequatur nobis, rerum. Soluta debitis excepturi impedit, ipsam temporibus, animi provident est eaque minus dolores voluptates nesciunt ipsum asperiores repellat assumenda praesentium.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Magnam itaque distinctio quibusdam saepe non nostrum, ab! Deserunt neque delectus itaque sed provident magni molestiae error ex, aliquam porro dolore, libero.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fugiat, odio. Ipsa nisi iure, molestiae optio quasi tempora iusto atque laborum quas ipsum, recusandae quo. Nisi ipsam, maiores asperiores beatae quos.</p>

	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eligendi commodi cupiditate laboriosam harum voluptates vitae eveniet maxime. Ab, explicabo recusandae illum natus assumenda! Doloremque facere ea sit reprehenderit reiciendis velit.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ut, sed ea consequatur asperiores tempora, quo aut! Consequatur nobis harum, perspiciatis obcaecati quisquam provident aspernatur iusto at ratione, nam recusandae aliquid?</p>

	<div style="min-height: 1000px; background: #222; position: relative; padding: 5vw">
		
		<ul class="stick" style="">
			<li class="is-active">One 1</li>
			<li>Two 2</li>
			<li>Three 3</li>
		</ul>
		<div class="dummy"></div>
		<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quisquam sint facilis iure excepturi voluptates voluptatibus voluptatum beatae, ullam, earum dolore quae ipsa soluta eaque molestiae ratione fuga veniam nam necessitatibus!</p>
		<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reprehenderit ipsum accusantium ipsam adipisci perspiciatis illum in, eum magnam, illo vitae facere nesciunt vel qui sunt sapiente, cupiditate deserunt. Voluptatum, magni. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ratione optio adipisci cumque qui consequuntur odit officia voluptates inventore in porro beatae quos, illum fugiat maiores. Facilis enim atque, itaque accusamus!</p>
	</div>

	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequatur nobis, rerum. Soluta debitis excepturi impedit, ipsam temporibus, animi provident est eaque minus dolores voluptates nesciunt ipsum asperiores repellat assumenda praesentium.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Magnam itaque distinctio quibusdam saepe non nostrum, ab! Deserunt neque delectus itaque sed provident magni molestiae error ex, aliquam porro dolore, libero.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fugiat, odio. Ipsa nisi iure, molestiae optio quasi tempora iusto atque laborum quas ipsum, recusandae quo. Nisi ipsam, maiores asperiores beatae quos.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eligendi commodi cupiditate laboriosam harum voluptates vitae eveniet maxime. Ab, explicabo recusandae illum natus assumenda! Doloremque facere ea sit reprehenderit reiciendis velit.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ut, sed ea consequatur asperiores tempora, quo aut! Consequatur nobis harum, perspiciatis obcaecati quisquam provident aspernatur iusto at ratione, nam recusandae aliquid?</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequatur nobis, rerum. Soluta debitis excepturi impedit, ipsam temporibus, animi provident est eaque minus dolores voluptates nesciunt ipsum asperiores repellat assumenda praesentium.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Magnam itaque distinctio quibusdam saepe non nostrum, ab! Deserunt neque delectus itaque sed provident magni molestiae error ex, aliquam porro dolore, libero.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fugiat, odio. Ipsa nisi iure, molestiae optio quasi tempora iusto atque laborum quas ipsum, recusandae quo. Nisi ipsam, maiores asperiores beatae quos.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eligendi commodi cupiditate laboriosam harum voluptates vitae eveniet maxime. Ab, explicabo recusandae illum natus assumenda! Doloremque facere ea sit reprehenderit reiciendis velit.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ut, sed ea consequatur asperiores tempora, quo aut! Consequatur nobis harum, perspiciatis obcaecati quisquam provident aspernatur iusto at ratione, nam recusandae aliquid?</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequatur nobis, rerum. Soluta debitis excepturi impedit, ipsam temporibus, animi provident est eaque minus dolores voluptates nesciunt ipsum asperiores repellat assumenda praesentium.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Magnam itaque distinctio quibusdam saepe non nostrum, ab! Deserunt neque delectus itaque sed provident magni molestiae error ex, aliquam porro dolore, libero.</p>
	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fugiat, odio. Ipsa nisi iure, molestiae optio quasi tempora iusto atque laborum quas ipsum, recusandae quo. Nisi ipsam, maiores asperiores beatae quos.</p>
	<script type="text/javascript">
		var doc = document.documentElement;

var stick = document.querySelector( '.stick' );
var measure = document.querySelector( '.is-active' );
var stickFrom = stick.getBoundingClientRect();

var bodyRect = document.documentElement.getBoundingClientRect(),
    elemRect = measure.getBoundingClientRect(),
    offset   = elemRect.top - bodyRect.top;


		// https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener
		var passSupp = false;


		try {
			var opts = {
				get passive() {
					passSupp = true;
				}
			};

			window.addEventListener( 'test', opts, opts );
			window.removeEventListener( 'test', opts, opts );
		} catch( err ) {
			passSupp = false;
		}

		// console.log( passSupp );

	var scrollFade = function ( elem ) {
		var t = this;
		t.root = elem;
	};

	scrollFade.prototype = {


		scrollEvent: function () {
			var t = this;
			var top = ( window.pageYOffset || doc.scrollTop ) - ( doc.clientTop || 0 );




			console.log( top, offset );


			 if ( top > ( offset + 153 ) ) {
			//if ( top >= offset ) {
				console.log( 'Stuck!' );
				stick.classList.add( 'is-stuck' );
			} 
			// if ( top < offset + 51 ) {
			else {
				console.log( 'Unstuck!' );
				stick.classList.remove( 'is-stuck' );
			}

			// if ( top < defs.offset ) {
			// 	var tmp = Number( 1 - ( top / defs.offset ) );

			// 	console.log( 'scrollEvent!', top, tmp, t.root );
			// 	t.root.style.opacity = tmp;

			// }

			// if ( top > defs.offset ) {
			// 	console.log( 'more than defs.offset' );
			// 	t.root.style.opacity = 0;
			// }
			this.isScrolling = false;
		},

		 scrollHandler: function () {
				if ( ! this.isScrolling ) {
					window.requestAnimationFrame( lorem.scrollEvent );
				}
				isScrolling = true;
			},
	};

	var lorem = new scrollFade();


	window.addEventListener( 'scroll', lorem.scrollHandler, passSupp ? { passive: true } : false );


	</script>
</body>
</html>